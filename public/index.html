<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload & Xem ·∫¢nh</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>üì∑ Upload & Xem ·∫¢nh</h1>

        <!-- Upload ·∫¢nh -->
        <div class="box">
            <h2>üì§ Upload ·∫¢nh</h2>
            <input type="file" id="fileInput">
            <button onclick="uploadImage()">Upload</button>
            <p id="uploadResult"></p>
        </div>

        <!-- Xem ·∫¢nh -->
        <div class="box">
            <h2>üîç Xem ·∫¢nh</h2>
            <input type="text" id="imageId" placeholder="Nh·∫≠p ID ·∫£nh">
            <button onclick="viewImage()">Xem</button>
        </div>

        <div id="imageContainer"></div>
    </div>

    <script>
        function uploadImage() {
            const fileInput = document.getElementById("fileInput");
            const file = fileInput.files[0];
            if (!file) return alert("Vui l√≤ng ch·ªçn file!");

            const formData = new FormData();
            formData.append("image", file);

            fetch("/upload", { method: "POST", body: formData })
                .then(res => res.json())
                .then(data => {
                    document.getElementById("uploadResult").innerHTML = 
                        `‚úÖ Upload th√†nh c√¥ng! ID: <strong>${data.id}</strong>`;
                })
                .catch(err => console.error("L·ªói:", err));
        }

        function viewImage() {
            const id = document.getElementById("imageId").value.trim();
            if (!id) return alert("Vui l√≤ng nh·∫≠p ID!");

            fetch(`/image/${id}`)
                .then(res => res.json())
                .then(data => {
                    if (data.fileUrl) {
                        document.getElementById("imageContainer").innerHTML = 
                            `<img src="${data.fileUrl}" alt="·∫¢nh ${id}" class="preview">`;
                    } else {
                        document.getElementById("imageContainer").innerHTML = `<p class="error">‚ùå Kh√¥ng t√¨m th·∫•y ·∫£nh!</p>`;
                    }
                })
                .catch(err => console.error("L·ªói:", err));
        }
    </script>
</body>
</html>